// Peity jQuery plugin version 2.0.2
// (c) 2014 Ben Pickles
//
// http://benpickles.github.io/peity
//
// Released under MIT license.
(function(e,t,n){var r=function(n,r){var i=t.createElementNS("http://www.w3.org/2000/svg",n);e.each(r,function(e,t){i.setAttribute(e,t)});return i};var i="createElementNS"in t&&r("svg",{}).createSVGRect;var s=1/(window.devicePixelRatio||1);var o=e.fn.peity=function(t,n){if(i){this.each(function(){var r=e(this);var i=r.data("peity");if(i){if(t)i.type=t;e.extend(i.opts,n)}else{var s=o.defaults[t];var a={};e.each(r.data(),function(e,t){if(e in s)a[e]=t});var f=e.extend({},s,a,n);i=new u(r,t,f);r.change(function(){i.draw()}).data("peity",i)}i.draw()})}return this};var u=function(e,t,n){this.$el=e;this.type=t;this.opts=n};var a=u.prototype;a.draw=function(){o.graphers[this.type].call(this,this.opts)};a.fill=function(){var t=this.opts.fill;var n=t;if(!e.isFunction(n)){n=function(e,n){return t[n%t.length]}}return n};a.prepare=function(t,n){var i;if(t=="auto")t=e(this.$el[0].parentNode).width();if(this.svg){i=e(this.svg).empty()}else{this.svg=r("svg",{"class":"peity"});this.$el.hide().after(this.svg);i=e(this.svg).data("peity",this)}this.svg.setAttribute("height",n);this.svg.setAttribute("width",t);return i};a.values=function(){return e.map(this.$el.text().split(this.opts.delimiter),function(e){return parseFloat(e)})};o.defaults={};o.graphers={};o.register=function(e,t,n){this.defaults[e]=t;this.graphers[e]=n};o.register("pie",{delimiter:null,diameter:16,fill:["#ff9900","#fff4dd","#ffc66e"]},function(e){if(!e.delimiter){var t=this.$el.text().match(/[^0-9\.]/);e.delimiter=t?t[0]:","}var i=this.values();if(e.delimiter=="/"){var s=i[0];var o=i[1];i=[s,n.max(0,o-s)]}var u=0;var a=i.length;var f=0;for(;u<a;u++){f+=i[u]}var l=this.prepare(e.width||e.diameter,e.height||e.diameter);var c=l.width(),h=l.height(),p=c/2,d=h/2;var v=n.min(p,d);var m=n.PI;var g=this.fill();var y=-m/2;for(u=0;u<a;u++){var b=i[u],w=b/f,E;if(w==0)continue;if(w==1){E=r("circle",{cx:p,cy:d,r:v})}else{var S=w*m*2,x=y+S,T=v*n.cos(y)+p,N=v*n.sin(y)+d,C=v*n.cos(x)+p,k=v*n.sin(x)+d;var L=["M",p,d,"L",T,N,"A",v,v,0,S>m?1:0,1,C,k,"Z"];E=r("path",{d:L.join(" ")});y=x}E.setAttribute("fill",g.call(this,b,u,i));this.svg.appendChild(E)}});o.register("line",{delimiter:",",fill:"#c6d9fd",height:16,max:null,min:0,stroke:"#4d89f9",strokeWidth:1,width:32},function(e){var t=this.values();if(t.length==1)t.push(t[0]);var i=n.max.apply(n,t.concat([e.max]));var s=n.min.apply(n,t.concat([e.min]));var o=this.prepare(e.width,e.height),u=o.width(),a=o.height()-e.strokeWidth,f=u/(t.length-1),l=a/(i-s),c=a+s*l,h=[0,c];for(var p=0;p<t.length;p++){var d=p*f;var v=a-l*(t[p]-s)+e.strokeWidth/2;h.push(d,v)}h.push(u,c);var m=r("polygon",{fill:e.fill,points:h.join(" ")});this.svg.appendChild(m);if(e.strokeWidth){var g=r("polyline",{fill:"transparent",points:h.slice(2,h.length-2).join(" "),stroke:e.stroke,"stroke-width":e.strokeWidth,"stroke-linecap":"square"});this.svg.appendChild(g)}});o.register("bar",{delimiter:",",fill:["#4D89F9"],gap:1,height:16,max:null,min:0,width:32},function(e){var t=this.values();var i=n.max.apply(n,t.concat([e.max]));var o=n.min.apply(n,t.concat([e.min]));var u=this.prepare(e.width,e.height),a=u.width(),f=u.height(),l=i-o,c=l==0?0:f/l,h=e.gap,p=(a+h)/t.length,d=this.fill();for(var v=0;v<t.length;v++){var m=t[v];var g=f-c*(m-o);var y=c*m;if(y==0){y=s;if(o<=0&&i>0||l==0)g-=s}else if(y<0){g+=y;y=-y}var b=r("rect",{fill:d.call(this,m,v,t),x:v*p,y:g,width:p-h,height:y});this.svg.appendChild(b)}})})(jQuery,document,Math)